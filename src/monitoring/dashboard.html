<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bright Data Integration - Monitoring Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2d3748;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #718096;
            font-size: 14px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .metric-title {
            color: #4a5568;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metric-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .metric-change {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .metric-change.positive {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .metric-change.negative {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .metric-change.neutral {
            background: #e2e8f0;
            color: #2d3748;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .chart-controls {
            display: flex;
            gap: 10px;
        }
        
        .chart-control {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            background: white;
            color: #4a5568;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .chart-control:hover {
            background: #f7fafc;
        }
        
        .chart-control.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .status-item {
            padding: 15px;
            border-radius: 8px;
            background: #f7fafc;
            border-left: 4px solid;
        }
        
        .status-item.success {
            border-color: #48bb78;
        }
        
        .status-item.warning {
            border-color: #f6ad55;
        }
        
        .status-item.error {
            border-color: #f56565;
        }
        
        .status-label {
            font-size: 12px;
            color: #718096;
            margin-bottom: 5px;
        }
        
        .status-value {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .alert-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }
        
        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .alert-title {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .alert-list {
            list-style: none;
        }
        
        .alert-item {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .alert-item.critical {
            background: #fff5f5;
            border: 1px solid #fc8181;
        }
        
        .alert-item.warning {
            background: #fffdf7;
            border: 1px solid #f6ad55;
        }
        
        .alert-item.info {
            background: #ebf8ff;
            border: 1px solid #63b3ed;
        }
        
        .alert-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .alert-content {
            flex: 1;
        }
        
        .alert-message {
            font-size: 14px;
            color: #2d3748;
            margin-bottom: 2px;
        }
        
        .alert-time {
            font-size: 12px;
            color: #a0aec0;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #e2e8f0;
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .refresh-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            padding: 12px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .refresh-text {
            font-size: 12px;
            color: #4a5568;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .status-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Bright Data Integration Monitor</h1>
            <div class="subtitle">Real-time LinkedIn profile enrichment metrics</div>
        </header>
        
        <!-- Key Metrics -->
        <div class="dashboard-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Success Rate</span>
                    <div class="metric-icon" style="background: #c6f6d5;">‚úì</div>
                </div>
                <div class="metric-value" id="success-rate">0%</div>
                <div class="metric-change positive">
                    <span>‚Üë</span>
                    <span>+5.2%</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Profiles Enriched</span>
                    <div class="metric-icon" style="background: #bee3f8;">üë§</div>
                </div>
                <div class="metric-value" id="profiles-enriched">0</div>
                <div class="metric-change positive">
                    <span>‚Üë</span>
                    <span>+127 today</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Avg Response Time</span>
                    <div class="metric-icon" style="background: #fbd38d;">‚ö°</div>
                </div>
                <div class="metric-value" id="avg-response-time">0ms</div>
                <div class="metric-change negative">
                    <span>‚Üë</span>
                    <span>+230ms</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Cache Hit Rate</span>
                    <div class="metric-icon" style="background: #d6f5d6;">üíæ</div>
                </div>
                <div class="metric-value" id="cache-hit-rate">0%</div>
                <div class="metric-change positive">
                    <span>‚Üë</span>
                    <span>+12%</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">API Cost Today</span>
                    <div class="metric-icon" style="background: #fbb6ce;">üí∞</div>
                </div>
                <div class="metric-value" id="api-cost">$0.00</div>
                <div class="metric-change neutral">
                    <span>‚Üí</span>
                    <span>On budget</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Data Quality Score</span>
                    <div class="metric-icon" style="background: #e9d8fd;">üìä</div>
                </div>
                <div class="metric-value" id="quality-score">0</div>
                <div class="metric-change positive">
                    <span>‚Üë</span>
                    <span>+8 pts</span>
                </div>
            </div>
        </div>
        
        <!-- Enrichment Timeline Chart -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Enrichment Activity</h2>
                <div class="chart-controls">
                    <button class="chart-control active" data-range="1h">1H</button>
                    <button class="chart-control" data-range="24h">24H</button>
                    <button class="chart-control" data-range="7d">7D</button>
                    <button class="chart-control" data-range="30d">30D</button>
                </div>
            </div>
            <canvas id="timeline-chart" height="80"></canvas>
        </div>
        
        <!-- Status Distribution -->
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Enrichment Status Distribution</h2>
            </div>
            <div class="status-grid">
                <div class="status-item success">
                    <div class="status-label">Successful</div>
                    <div class="status-value" id="status-success">0</div>
                </div>
                <div class="status-item warning">
                    <div class="status-label">Partial Data</div>
                    <div class="status-value" id="status-partial">0</div>
                </div>
                <div class="status-item error">
                    <div class="status-label">Failed</div>
                    <div class="status-value" id="status-failed">0</div>
                </div>
                <div class="status-item success">
                    <div class="status-label">From Cache</div>
                    <div class="status-value" id="status-cached">0</div>
                </div>
            </div>
        </div>
        
        <!-- Performance Charts -->
        <div class="dashboard-grid">
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Data Source Distribution</h2>
                </div>
                <canvas id="source-chart" height="200"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Quality Score Distribution</h2>
                </div>
                <canvas id="quality-chart" height="200"></canvas>
            </div>
        </div>
        
        <!-- Active Alerts -->
        <div class="alert-box">
            <div class="alert-header">
                <h2 class="alert-title">Active Alerts</h2>
                <span class="subtitle" id="alert-count">0 alerts</span>
            </div>
            <ul class="alert-list" id="alert-list">
                <!-- Alerts will be dynamically added here -->
            </ul>
        </div>
        
        <!-- Refresh Indicator -->
        <div class="refresh-indicator">
            <div class="loading"></div>
            <span class="refresh-text">Auto-refresh in <span id="refresh-countdown">30</span>s</span>
        </div>
    </div>
    
    <script>
        // Dashboard Controller
        class Dashboard {
            constructor() {
                this.charts = {};
                this.refreshInterval = 30000; // 30 seconds
                this.countdownInterval = null;
                this.countdown = 30;
                
                this.initCharts();
                this.startAutoRefresh();
                this.loadData();
                this.setupEventListeners();
            }
            
            initCharts() {
                // Timeline Chart
                const timelineCtx = document.getElementById('timeline-chart').getContext('2d');
                this.charts.timeline = new Chart(timelineCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'Successful',
                                data: [],
                                borderColor: '#48bb78',
                                backgroundColor: 'rgba(72, 187, 120, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'Failed',
                                data: [],
                                borderColor: '#f56565',
                                backgroundColor: 'rgba(245, 101, 101, 0.1)',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'bottom'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                
                // Source Distribution Chart
                const sourceCtx = document.getElementById('source-chart').getContext('2d');
                this.charts.source = new Chart(sourceCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Bright Data', 'Apify Fallback', 'Cache', 'Manual'],
                        datasets: [{
                            data: [0, 0, 0, 0],
                            backgroundColor: [
                                '#667eea',
                                '#f6ad55',
                                '#48bb78',
                                '#a0aec0'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                
                // Quality Score Chart
                const qualityCtx = document.getElementById('quality-chart').getContext('2d');
                this.charts.quality = new Chart(qualityCtx, {
                    type: 'bar',
                    data: {
                        labels: ['0-20', '21-40', '41-60', '61-80', '81-100'],
                        datasets: [{
                            label: 'Profiles',
                            data: [0, 0, 0, 0, 0],
                            backgroundColor: [
                                '#f56565',
                                '#f6ad55',
                                '#f6e05e',
                                '#68d391',
                                '#48bb78'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            async loadData() {
                try {
                    // Simulate API call - in production, fetch from real endpoint
                    const data = await this.fetchMetrics();
                    this.updateMetrics(data);
                    this.updateCharts(data);
                    this.updateAlerts(data.alerts);
                } catch (error) {
                    console.error('Failed to load dashboard data:', error);
                }
            }
            
            async fetchMetrics() {
                // In production, this would fetch from your monitoring API
                // For now, return simulated data
                return {
                    successRate: 94.5,
                    profilesEnriched: 1847,
                    avgResponseTime: 1250,
                    cacheHitRate: 68,
                    apiCost: 147.76,
                    qualityScore: 82,
                    timeline: {
                        labels: this.generateTimeLabels(24),
                        successful: this.generateRandomData(24, 50, 100),
                        failed: this.generateRandomData(24, 0, 10)
                    },
                    sourceDistribution: [720, 180, 820, 127],
                    qualityDistribution: [45, 123, 287, 892, 500],
                    statusCounts: {
                        success: 1523,
                        partial: 214,
                        failed: 87,
                        cached: 820
                    },
                    alerts: [
                        {
                            level: 'warning',
                            message: 'API response time degraded (>2s average)',
                            time: new Date(Date.now() - 900000).toISOString()
                        },
                        {
                            level: 'info',
                            message: 'Cache memory usage at 78%',
                            time: new Date(Date.now() - 1800000).toISOString()
                        }
                    ]
                };
            }
            
            updateMetrics(data) {
                document.getElementById('success-rate').textContent = `${data.successRate}%`;
                document.getElementById('profiles-enriched').textContent = data.profilesEnriched.toLocaleString();
                document.getElementById('avg-response-time').textContent = `${data.avgResponseTime}ms`;
                document.getElementById('cache-hit-rate').textContent = `${data.cacheHitRate}%`;
                document.getElementById('api-cost').textContent = `$${data.apiCost.toFixed(2)}`;
                document.getElementById('quality-score').textContent = data.qualityScore;
                
                document.getElementById('status-success').textContent = data.statusCounts.success.toLocaleString();
                document.getElementById('status-partial').textContent = data.statusCounts.partial.toLocaleString();
                document.getElementById('status-failed').textContent = data.statusCounts.failed.toLocaleString();
                document.getElementById('status-cached').textContent = data.statusCounts.cached.toLocaleString();
            }
            
            updateCharts(data) {
                // Update timeline chart
                this.charts.timeline.data.labels = data.timeline.labels;
                this.charts.timeline.data.datasets[0].data = data.timeline.successful;
                this.charts.timeline.data.datasets[1].data = data.timeline.failed;
                this.charts.timeline.update();
                
                // Update source distribution
                this.charts.source.data.datasets[0].data = data.sourceDistribution;
                this.charts.source.update();
                
                // Update quality distribution
                this.charts.quality.data.datasets[0].data = data.qualityDistribution;
                this.charts.quality.update();
            }
            
            updateAlerts(alerts) {
                const alertList = document.getElementById('alert-list');
                const alertCount = document.getElementById('alert-count');
                
                alertCount.textContent = `${alerts.length} alert${alerts.length !== 1 ? 's' : ''}`;
                
                alertList.innerHTML = '';
                alerts.forEach(alert => {
                    const alertItem = document.createElement('li');
                    alertItem.className = `alert-item ${alert.level}`;
                    
                    const iconColors = {
                        critical: '#fc8181',
                        warning: '#f6ad55',
                        info: '#63b3ed'
                    };
                    
                    const icons = {
                        critical: '!',
                        warning: '‚ö†',
                        info: '‚Ñπ'
                    };
                    
                    alertItem.innerHTML = `
                        <div class="alert-icon" style="background: ${iconColors[alert.level]}; color: white;">
                            ${icons[alert.level]}
                        </div>
                        <div class="alert-content">
                            <div class="alert-message">${alert.message}</div>
                            <div class="alert-time">${this.formatTime(alert.time)}</div>
                        </div>
                    `;
                    
                    alertList.appendChild(alertItem);
                });
                
                if (alerts.length === 0) {
                    alertList.innerHTML = '<li style="padding: 20px; text-align: center; color: #a0aec0;">No active alerts</li>';
                }
            }
            
            generateTimeLabels(hours) {
                const labels = [];
                const now = new Date();
                for (let i = hours - 1; i >= 0; i--) {
                    const time = new Date(now - i * 3600000);
                    labels.push(time.getHours() + ':00');
                }
                return labels;
            }
            
            generateRandomData(count, min, max) {
                return Array.from({ length: count }, () => 
                    Math.floor(Math.random() * (max - min + 1)) + min
                );
            }
            
            formatTime(timestamp) {
                const date = new Date(timestamp);
                const now = new Date();
                const diff = now - date;
                
                if (diff < 60000) return 'Just now';
                if (diff < 3600000) return `${Math.floor(diff / 60000)} minutes ago`;
                if (diff < 86400000) return `${Math.floor(diff / 3600000)} hours ago`;
                return date.toLocaleDateString();
            }
            
            setupEventListeners() {
                // Time range controls
                document.querySelectorAll('.chart-control').forEach(button => {
                    button.addEventListener('click', (e) => {
                        document.querySelectorAll('.chart-control').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.loadData(); // Reload with new time range
                    });
                });
            }
            
            startAutoRefresh() {
                // Countdown timer
                this.countdownInterval = setInterval(() => {
                    this.countdown--;
                    document.getElementById('refresh-countdown').textContent = this.countdown;
                    
                    if (this.countdown <= 0) {
                        this.countdown = 30;
                        this.loadData();
                    }
                }, 1000);
                
                // Auto refresh data
                setInterval(() => {
                    this.loadData();
                }, this.refreshInterval);
            }
        }
        
        // Initialize dashboard when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new Dashboard();
        });
    </script>
</body>
</html>